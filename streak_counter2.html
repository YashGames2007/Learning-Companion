<!DOCTYPE html>
<html lang="en">
    <head>
        <meta charset="UTF-8" />
        <meta name="viewport" content="width=device-width, initial-scale=1.0" />
        <title>GitHub-Style Streak Visualizer</title>
        <style>
            * {
                margin: 0;
                padding: 0;
                box-sizing: border-box;
            }

            body {
                font-family: -apple-system, BlinkMacSystemFont, "Segoe UI",
                    Roboto, sans-serif;
                background: #0d1117;
                color: #e6edf3;
                padding: 40px 20px;
                min-height: 100vh;
            }

            .container {
                max-width: 1200px;
                margin: 0 auto;
                background: #161b22;
                border-radius: 12px;
                padding: 30px;
                border: 1px solid #30363d;
            }

            .header {
                display: flex;
                justify-content: space-between;
                align-items: center;
                margin-bottom: 20px;
                flex-wrap: wrap;
                gap: 15px;
            }

            .contributions-text {
                font-size: 14px;
                color: #7d8590;
            }

            .contributions-count {
                color: #e6edf3;
                font-weight: 600;
            }

            .year-selector {
                display: flex;
                align-items: center;
                gap: 10px;
            }

            .year-button {
                background: #21262d;
                border: 1px solid #30363d;
                color: #e6edf3;
                padding: 8px 16px;
                border-radius: 6px;
                cursor: pointer;
                font-size: 14px;
                transition: all 0.2s;
            }

            .year-button:hover {
                background: #30363d;
            }

            .year-button.active {
                background: #238636;
                border-color: #238636;
            }

            .graph-container {
                position: relative;
                overflow-x: auto;
                padding-bottom: 10px;
            }

            .contribution-graph {
                display: grid;
                grid-template-columns: auto 1fr;
                gap: 10px;
                min-width: 800px;
            }

            .months-labels {
                display: grid;
                grid-template-columns: repeat(53, 1fr);
                gap: 3px;
                margin-left: 27px;
                margin-bottom: 8px;
            }

            .month-label {
                font-size: 12px;
                color: #7d8590;
                text-align: left;
                padding-left: 2px;
            }

            .days-labels {
                display: grid;
                grid-template-rows: repeat(7, 1fr);
                gap: 3px;
                padding-right: 8px;
            }

            .day-label {
                font-size: 12px;
                color: #7d8590;
                height: 11px;
                display: flex;
                align-items: center;
                justify-content: flex-end;
            }

            .weeks-container {
                display: grid;
                grid-template-columns: repeat(53, 1fr);
                gap: 3px;
            }

            .week {
                display: grid;
                grid-template-rows: repeat(7, 1fr);
                gap: 3px;
            }

            .day {
                width: 11px;
                height: 11px;
                border-radius: 2px;
                cursor: pointer;
                transition: all 0.1s;
            }

            .day:hover {
                stroke: #e6edf3;
                stroke-width: 1px;
                outline: 1px solid #e6edf3;
            }

            /* Contribution levels - GitHub style */
            .day.level-0 {
                background-color: #161b22;
                border: 1px solid #1b1f23;
            }

            .day.level-1 {
                background-color: #0e4429;
            }

            .day.level-2 {
                background-color: #006d32;
            }

            .day.level-3 {
                background-color: #26a641;
            }

            .day.level-4 {
                background-color: #39d353;
            }

            .legend {
                display: flex;
                justify-content: flex-end;
                align-items: center;
                gap: 8px;
                margin-top: 15px;
                font-size: 12px;
                color: #7d8590;
            }

            .legend-item {
                display: flex;
                align-items: center;
                gap: 4px;
            }

            .legend-squares {
                display: flex;
                gap: 3px;
            }

            .legend-square {
                width: 11px;
                height: 11px;
                border-radius: 2px;
            }

            .controls {
                display: flex;
                justify-content: center;
                gap: 15px;
                margin-top: 20px;
                flex-wrap: wrap;
            }

            .btn {
                background: #238636;
                color: #ffffff;
                border: none;
                padding: 10px 16px;
                border-radius: 6px;
                font-size: 14px;
                font-weight: 500;
                cursor: pointer;
                transition: background 0.2s;
            }

            .btn:hover {
                background: #2ea043;
            }

            .btn-secondary {
                background: #21262d;
                border: 1px solid #30363d;
            }

            .btn-secondary:hover {
                background: #30363d;
            }

            .stats {
                display: grid;
                grid-template-columns: repeat(auto-fit, minmax(150px, 1fr));
                gap: 15px;
                margin-top: 20px;
                padding: 20px;
                background: #0d1117;
                border-radius: 8px;
                border: 1px solid #21262d;
            }

            .stat {
                text-align: center;
            }

            .stat-number {
                font-size: 24px;
                font-weight: 600;
                color: #39d353;
                margin-bottom: 4px;
            }

            .stat-label {
                font-size: 12px;
                color: #7d8590;
            }

            .tooltip {
                position: absolute;
                background: #1c2128;
                border: 1px solid #30363d;
                border-radius: 6px;
                padding: 8px 12px;
                font-size: 12px;
                color: #e6edf3;
                pointer-events: none;
                z-index: 1000;
                opacity: 0;
                transition: opacity 0.2s;
                box-shadow: 0 8px 24px rgba(0, 0, 0, 0.3);
            }

            .tooltip.show {
                opacity: 1;
            }
        </style>
    </head>
    <body>
        <div class="container">
            <div class="header">
                <div class="contributions-text">
                    <span class="contributions-count" id="contributionsCount"
                        >0</span
                    >
                    contributions in the last year
                </div>
                <div class="year-selector">
                    <button
                        class="year-button"
                        onclick="visualizer.changeYear(2023)"
                    >
                        2023
                    </button>
                    <button
                        class="year-button"
                        onclick="visualizer.changeYear(2024)"
                    >
                        2024
                    </button>
                    <button
                        class="year-button active"
                        onclick="visualizer.changeYear(2025)"
                    >
                        2025
                    </button>
                </div>
            </div>

            <div class="graph-container">
                <!-- Month labels -->
                <div class="months-labels" id="monthsLabels"></div>

                <div class="contribution-graph">
                    <!-- Day labels -->
                    <div class="days-labels">
                        <div class="day-label">Sun</div>
                        <div class="day-label">Mon</div>
                        <div class="day-label"></div>
                        <div class="day-label">Wed</div>
                        <div class="day-label"></div>
                        <div class="day-label">Fri</div>
                        <div class="day-label"></div>
                    </div>

                    <!-- Weeks container -->
                    <div class="weeks-container" id="weeksContainer"></div>
                </div>
            </div>

            <div class="legend">
                <span>Less</span>
                <div class="legend-squares">
                    <div class="legend-square level-0"></div>
                    <div class="legend-square level-1"></div>
                    <div class="legend-square level-2"></div>
                    <div class="legend-square level-3"></div>
                    <div class="legend-square level-4"></div>
                </div>
                <span>More</span>
            </div>

            <div class="controls">
                <button class="btn" onclick="visualizer.addRandomActivity()">
                    Add Random Activity
                </button>
                <button class="btn" onclick="visualizer.completeToday()">
                    Complete Today
                </button>
                <button
                    class="btn btn-secondary"
                    onclick="visualizer.clearData()"
                >
                    Clear All
                </button>
                <button
                    class="btn btn-secondary"
                    onclick="visualizer.exportData()"
                >
                    Export Data
                </button>
                <input
                    type="file"
                    id="importFile"
                    accept=".json"
                    onchange="visualizer.importData(event)"
                    style="display: none"
                />
                <button
                    class="btn btn-secondary"
                    onclick="document.getElementById('importFile').click()"
                >
                    Import Data
                </button>
            </div>

            <div class="stats">
                <div class="stat">
                    <div class="stat-number" id="totalContributions">0</div>
                    <div class="stat-label">Total contributions</div>
                </div>
                <div class="stat">
                    <div class="stat-number" id="longestStreak">0</div>
                    <div class="stat-label">Longest streak</div>
                </div>
                <div class="stat">
                    <div class="stat-number" id="currentStreak">0</div>
                    <div class="stat-label">Current streak</div>
                </div>
                <div class="stat">
                    <div class="stat-number" id="averagePerDay">0.0</div>
                    <div class="stat-label">Average per day</div>
                </div>
            </div>
        </div>

        <!-- Tooltip -->
        <div class="tooltip" id="tooltip"></div>

        <script>
            class GitHubStyleVisualizer {
                constructor() {
                    this.currentYear = 2025;
                    this.data =
                        JSON.parse(localStorage.getItem("contributionData")) ||
                        {};
                    this.init();
                }

                init() {
                    this.renderGraph();
                    this.updateStats();
                }

                changeYear(year) {
                    this.currentYear = year;

                    // Update active button
                    document.querySelectorAll(".year-button").forEach((btn) => {
                        btn.classList.remove("active");
                        if (btn.textContent === year.toString()) {
                            btn.classList.add("active");
                        }
                    });

                    this.renderGraph();
                    this.updateStats();
                }

                renderGraph() {
                    const weeksContainer =
                        document.getElementById("weeksContainer");
                    const monthsLabels =
                        document.getElementById("monthsLabels");

                    // Clear existing content
                    weeksContainer.innerHTML = "";
                    monthsLabels.innerHTML = "";

                    // Get year boundaries
                    const startOfYear = new Date(this.currentYear, 0, 1);
                    const endOfYear = new Date(this.currentYear, 11, 31);

                    // Find the Sunday before or on start of year
                    const startDate = new Date(startOfYear);
                    startDate.setDate(startDate.getDate() - startDate.getDay());

                    // Calculate total weeks needed
                    const totalDays =
                        Math.ceil(
                            (endOfYear - startDate) / (1000 * 60 * 60 * 24)
                        ) + 1;
                    const totalWeeks = Math.ceil(totalDays / 7);

                    // Generate month labels
                    let currentMonth = -1;
                    for (let week = 0; week < totalWeeks; week++) {
                        const weekStart = new Date(startDate);
                        weekStart.setDate(startDate.getDate() + week * 7);

                        const monthLabel = document.createElement("div");
                        monthLabel.className = "month-label";

                        if (
                            weekStart.getMonth() !== currentMonth &&
                            weekStart.getDate() <= 7
                        ) {
                            const monthNames = [
                                "Jan",
                                "Feb",
                                "Mar",
                                "Apr",
                                "May",
                                "Jun",
                                "Jul",
                                "Aug",
                                "Sep",
                                "Oct",
                                "Nov",
                                "Dec",
                            ];
                            monthLabel.textContent =
                                monthNames[weekStart.getMonth()];
                            currentMonth = weekStart.getMonth();
                        }

                        monthsLabels.appendChild(monthLabel);
                    }

                    // Generate weeks
                    for (let week = 0; week < totalWeeks; week++) {
                        const weekDiv = document.createElement("div");
                        weekDiv.className = "week";

                        for (let day = 0; day < 7; day++) {
                            const currentDate = new Date(startDate);
                            currentDate.setDate(
                                startDate.getDate() + week * 7 + day
                            );

                            const dayDiv = document.createElement("div");
                            dayDiv.className = "day";

                            const dateStr = currentDate.toDateString();
                            const weight = this.data[dateStr] || 0;

                            // Set contribution level based on weight
                            const level = this.getContributionLevel(weight);
                            dayDiv.classList.add(`level-${level}`);

                            // Add hover tooltip
                            dayDiv.addEventListener("mouseenter", (e) => {
                                this.showTooltip(e, currentDate, weight);
                            });

                            dayDiv.addEventListener("mouseleave", () => {
                                this.hideTooltip();
                            });

                            // Add click to increment
                            dayDiv.addEventListener("click", () => {
                                this.incrementDay(dateStr);
                            });

                            weekDiv.appendChild(dayDiv);
                        }

                        weeksContainer.appendChild(weekDiv);
                    }
                }

                getContributionLevel(weight) {
                    if (weight === 0) return 0;
                    if (weight <= 3) return 1;
                    if (weight <= 6) return 2;
                    if (weight <= 9) return 3;
                    return 4;
                }

                showTooltip(event, date, weight) {
                    const tooltip = document.getElementById("tooltip");
                    const rect = event.target.getBoundingClientRect();

                    const dateStr = date.toLocaleDateString("en-US", {
                        weekday: "short",
                        month: "short",
                        day: "numeric",
                        year: "numeric",
                    });

                    const contributionText =
                        weight === 0
                            ? "No contributions"
                            : weight === 1
                            ? "1 contribution"
                            : `${weight} contributions`;

                    tooltip.innerHTML = `<strong>${contributionText}</strong><br>${dateStr}`;
                    tooltip.style.left = rect.left + window.scrollX + "px";
                    tooltip.style.top = rect.top + window.scrollY - 60 + "px";
                    tooltip.classList.add("show");
                }

                hideTooltip() {
                    document.getElementById("tooltip").classList.remove("show");
                }

                incrementDay(dateStr) {
                    this.data[dateStr] = (this.data[dateStr] || 0) + 1;
                    this.saveData();
                    this.renderGraph();
                    this.updateStats();
                }

                completeToday() {
                    const today = new Date();
                    const dateStr = today.toDateString();
                    this.data[dateStr] = (this.data[dateStr] || 0) + 1;
                    this.saveData();
                    this.renderGraph();
                    this.updateStats();
                }

                addRandomActivity() {
                    // Add random contributions to random days in current year
                    const startDate = new Date(this.currentYear, 0, 1);
                    const endDate = new Date(this.currentYear, 11, 31);
                    const days = Math.floor(
                        (endDate - startDate) / (1000 * 60 * 60 * 24)
                    );

                    for (let i = 0; i < 20; i++) {
                        const randomDay = Math.floor(Math.random() * days);
                        const date = new Date(startDate);
                        date.setDate(date.getDate() + randomDay);
                        const dateStr = date.toDateString();

                        this.data[dateStr] = Math.floor(Math.random() * 15) + 1;
                    }

                    this.saveData();
                    this.renderGraph();
                    this.updateStats();
                }

                updateStats() {
                    const yearData = this.getYearData();
                    const totalContributions = Object.values(yearData).reduce(
                        (sum, val) => sum + val,
                        0
                    );
                    const contributionDays = Object.keys(yearData).length;

                    document.getElementById("contributionsCount").textContent =
                        totalContributions;
                    document.getElementById("totalContributions").textContent =
                        totalContributions;
                    document.getElementById("averagePerDay").textContent =
                        contributionDays > 0
                            ? (totalContributions / contributionDays).toFixed(1)
                            : "0.0";

                    // Calculate streaks
                    const { longest, current } = this.calculateStreaks();
                    document.getElementById("longestStreak").textContent =
                        longest;
                    document.getElementById("currentStreak").textContent =
                        current;
                }

                getYearData() {
                    const yearData = {};
                    Object.keys(this.data).forEach((dateStr) => {
                        const date = new Date(dateStr);
                        if (date.getFullYear() === this.currentYear) {
                            yearData[dateStr] = this.data[dateStr];
                        }
                    });
                    return yearData;
                }

                calculateStreaks() {
                    const today = new Date();
                    let longestStreak = 0;
                    let currentStreak = 0;
                    let tempStreak = 0;

                    // Check from today backwards
                    for (let i = 0; i <= 365; i++) {
                        const checkDate = new Date(today);
                        checkDate.setDate(checkDate.getDate() - i);
                        const dateStr = checkDate.toDateString();

                        if (this.data[dateStr] && this.data[dateStr] > 0) {
                            tempStreak++;
                            if (i === 0 || currentStreak === tempStreak - 1) {
                                currentStreak = tempStreak;
                            }
                        } else {
                            longestStreak = Math.max(longestStreak, tempStreak);
                            if (currentStreak === tempStreak) {
                                currentStreak = 0;
                            }
                            tempStreak = 0;
                        }
                    }

                    longestStreak = Math.max(longestStreak, tempStreak);
                    return { longest: longestStreak, current: currentStreak };
                }

                saveData() {
                    localStorage.setItem(
                        "contributionData",
                        JSON.stringify(this.data)
                    );
                }

                clearData() {
                    if (confirm("Clear all contribution data?")) {
                        this.data = {};
                        this.saveData();
                        this.renderGraph();
                        this.updateStats();
                    }
                }

                exportData() {
                    const blob = new Blob(
                        [JSON.stringify(this.data, null, 2)],
                        {
                            type: "application/json",
                        }
                    );
                    const url = URL.createObjectURL(blob);
                    const a = document.createElement("a");
                    a.href = url;
                    a.download = "contribution-data.json";
                    a.click();
                }

                importData(event) {
                    const file = event.target.files[0];
                    if (!file) return;

                    const reader = new FileReader();
                    reader.onload = (e) => {
                        try {
                            this.data = JSON.parse(e.target.result);
                            this.saveData();
                            this.renderGraph();
                            this.updateStats();
                            alert("Data imported successfully!");
                        } catch (error) {
                            alert("Invalid file format");
                        }
                    };
                    reader.readAsText(file);
                }
            }

            // Initialize
            const visualizer = new GitHubStyleVisualizer();
        </script>
    </body>
</html>
